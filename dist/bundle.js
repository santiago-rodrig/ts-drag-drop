(()=>{"use strict";const e=class{constructor(e,t,r,n){this.templateEl=document.getElementById(e),this.targetNode=document.getElementById(t);const s=document.importNode(this.templateEl.content,!0);this.element=s.firstElementChild,n&&(this.element.id=n),this.attach(r)}attach(e){e?this.targetNode.insertAdjacentElement("afterbegin",this.element):this.targetNode.insertAdjacentElement("beforeend",this.element)}};function t(e,t,r){return{configurable:!0,enumerable:!1,get(){return r.value.bind(this)}}}var r;!function(e){e.ACTIVE="active",e.INACTIVE="finished"}(r||(r={}));class n{constructor(e,t,n,s){this.status=r.ACTIVE,this.title=e,this.description=t,this.people=n,this.id=Math.random().toString(),s&&(this.status=s)}}class s{constructor(){this._projects=[],this._listeners=[]}static getInstance(){return this._instance||(this._instance=new s),this._instance}moveProject(e,t){const r=this._projects.find((t=>t.id===e));r&&(r.status=t),this.callListeners()}addProject(e){this._projects.push(new n(...e)),this.callListeners()}getProjects(e){switch(e){case r.ACTIVE:return[...this._projects].filter((e=>e.status===r.ACTIVE));case r.INACTIVE:return[...this._projects].filter((e=>e.status===r.INACTIVE));default:return[...this._projects]}}callListeners(){this._listeners.forEach((e=>e()))}addListener(e){this._listeners.push(e)}}const i=s.getInstance();function l(e){const{value:t}=e;if("string"==typeof t){const{minLength:r,maxLength:n}=e;if(r&&r>t.length)return!1;if(n&&n<t.length)return!1}else{const{min:r,max:n}=e;if(r&&r>t)return!1;if(n&&n<t)return!1}return!0}class a extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInput=this.element.querySelector("#title"),this.descriptionInput=this.element.querySelector("#description"),this.peopleInput=this.element.querySelector("#people"),this.configure(),this.renderContents()}submitHandler(e){e.preventDefault();const t=this.getInputValues();t&&(i.addProject(t),this.clearInputValues())}clearInputValues(){this.titleInput.value="",this.descriptionInput.value="",this.peopleInput.value=""}getInputValues(){const e=this.titleInput.value,t=this.descriptionInput.value,r=this.peopleInput.value,n={value:t,minLength:5},s={value:+r,min:1,max:10};if(l({value:e,minLength:1})&&l(n)&&l(s))return[e,t,+r];alert("Invalid input values!")}renderContents(){}configure(){this.element.addEventListener("submit",this.submitHandler)}}!function(e,t,r,n){var s,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(l=(i<3?s(l):i>3?s(t,r,l):s(t,r))||l);i>3&&l&&Object.defineProperty(t,r,l)}([t],a.prototype,"submitHandler",null);var o=function(e,t,r,n){var s,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(l=(i<3?s(l):i>3?s(t,r,l):s(t,r))||l);return i>3&&l&&Object.defineProperty(t,r,l),l};class c extends e{constructor(e,t){super("single-project",e,!1),this._project=t,this.configure(),this.renderContents()}get projectMembers(){switch(this._project.people){case 1:return"1 member";default:return`${this._project.people} members`}}dragStartHandler(e){e.dataTransfer.setData("text/plain",this._project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){}configure(){this.element.id=this._project.id,this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContents(){this.element.querySelector("h2").textContent=this._project.title,this.element.querySelector("h3").textContent=this.projectMembers,this.element.querySelector("p").textContent=this._project.description}}o([t],c.prototype,"dragStartHandler",null),o([t],c.prototype,"dragEndHandler",null);var d=function(e,t,r,n){var s,i=arguments.length,l=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(l=(i<3?s(l):i>3?s(t,r,l):s(t,r))||l);return i>3&&l&&Object.defineProperty(t,r,l),l};class p extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.projects=[],this.configure(),this.renderContents()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dragDropHandler(e){const t=e.dataTransfer.getData("text/plain");i.moveProject(t,this.type),this.element.querySelector("ul").classList.remove("droppable")}dragLeaveHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&this.element.querySelector("ul").classList.remove("droppable")}renderProjects(){document.getElementById(`${this.type}-projects`).querySelector("ul").innerHTML="",this.projects.forEach((e=>{new c(`${this.type}-projects-list`,e)}))}configure(){i.addListener((()=>{this.projects=i.getProjects(this.type),this.renderProjects()})),this.element.querySelector("ul").id=`${this.type}-projects-list`,this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dragDropHandler)}renderContents(){this.element.querySelector("h2").textContent=`${this.type.toUpperCase()} PROJECTS`}}d([t],p.prototype,"dragOverHandler",null),d([t],p.prototype,"dragDropHandler",null),d([t],p.prototype,"dragLeaveHandler",null),new a,new p(r.ACTIVE),new p(r.INACTIVE)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9iYXNlLnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC8uL3NyYy9kZWNvcmF0b3JzLnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC8uL3NyYy9lbnVtcy50cyIsIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdHMtZHJhZy1kcm9wLy4vc3JjL3N0YXRlL3Byb2plY3RzLnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC8uL3NyYy92YWxpZGF0aW9ucy50cyIsIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3RzLWRyYWctZHJvcC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly90cy1kcmFnLWRyb3AvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdHMtZHJhZy1kcm9wLy4vc3JjL2FwcC50cyJdLCJuYW1lcyI6WyJ0ZW1wbGF0ZUlkIiwidGFyZ2V0Tm9kZUlkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRoaXMiLCJ0ZW1wbGF0ZUVsIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInRhcmdldE5vZGUiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImlkIiwiYXR0YWNoIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiQXV0b2JpbmQiLCJfMSIsIl8yIiwiZGVzY3JpcHRvciIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJ2YWx1ZSIsImJpbmQiLCJQcm9qZWN0U3RhdHVzIiwiUHJvamVjdCIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwZW9wbGUiLCJzdGF0dXMiLCJBQ1RJVkUiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJQcm9qZWN0U3RhdGUiLCJfcHJvamVjdHMiLCJfbGlzdGVuZXJzIiwiX2luc3RhbmNlIiwicHJvamVjdElkIiwibGlzdFR5cGUiLCJwcm9qZWN0SW5zdGFuY2UiLCJmaW5kIiwicHJvamVjdCIsImNhbGxMaXN0ZW5lcnMiLCJwcm9qZWN0RGF0YSIsInB1c2giLCJmaWx0ZXIiLCJJTkFDVElWRSIsImZvckVhY2giLCJsaXN0ZW5lciIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwidmFsaWRhdGUiLCJ2YWxpZGF0aW9uIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibGVuZ3RoIiwibWluIiwibWF4IiwiUHJvamVjdHNJbnB1dCIsInN1cGVyIiwidGl0bGVJbnB1dCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjcmlwdGlvbklucHV0IiwicGVvcGxlSW5wdXQiLCJjb25maWd1cmUiLCJyZW5kZXJDb250ZW50cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJpbnB1dFZhbHVlcyIsImdldElucHV0VmFsdWVzIiwiYWRkUHJvamVjdCIsImNsZWFySW5wdXRWYWx1ZXMiLCJ0aXRsZUlucHV0VmFsdWUiLCJkZXNjcmlwdGlvbklucHV0VmFsdWUiLCJwZW9wbGVJbnB1dFZhbHVlIiwiZGVzY3JpcHRpb25JbnB1dFZhbGlkYXRpb24iLCJwZW9wbGVJbnB1dFZhbGlkYXRpb24iLCJhbGVydCIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdWJtaXRIYW5kbGVyIiwiUHJvamVjdEl0ZW0iLCJob3N0SWQiLCJfcHJvamVjdCIsImRhdGFUcmFuc2ZlciIsInNldERhdGEiLCJlZmZlY3RBbGxvd2VkIiwiXyIsImRyYWdTdGFydEhhbmRsZXIiLCJkcmFnRW5kSGFuZGxlciIsInRleHRDb250ZW50IiwicHJvamVjdE1lbWJlcnMiLCJQcm9qZWN0c0xpc3QiLCJ0eXBlIiwicHJvamVjdHMiLCJ0eXBlcyIsImNsYXNzTGlzdCIsImFkZCIsImdldERhdGEiLCJtb3ZlUHJvamVjdCIsInJlbW92ZSIsImlubmVySFRNTCIsImFkZExpc3RlbmVyIiwiZ2V0UHJvamVjdHMiLCJyZW5kZXJQcm9qZWN0cyIsImRyYWdPdmVySGFuZGxlciIsImRyYWdMZWF2ZUhhbmRsZXIiLCJkcmFnRHJvcEhhbmRsZXIiLCJ0b1VwcGVyQ2FzZSJdLCJtYXBwaW5ncyI6Im1CQUFBLGNBS0ksWUFDSUEsRUFDQUMsRUFDQUMsRUFDQUMsR0FFQUMsS0FBS0MsV0FBYUMsU0FBU0MsZUFDdkJQLEdBR0pJLEtBQUtJLFdBQWFGLFNBQVNDLGVBQWVOLEdBQzFDLE1BQU1RLEVBQWVILFNBQVNJLFdBQVdOLEtBQUtDLFdBQVdNLFNBQVMsR0FDbEVQLEtBQUtRLFFBQVVILEVBQWFJLGtCQUN4QlYsSUFBY0MsS0FBS1EsUUFBUUUsR0FBS1gsR0FDcENDLEtBQUtXLE9BQU9iLEdBR1IsT0FBT0EsR0FDUEEsRUFDQUUsS0FBS0ksV0FBV1Esc0JBQXNCLGFBQWNaLEtBQUtRLFNBRXpEUixLQUFLSSxXQUFXUSxzQkFBc0IsWUFBYVosS0FBS1EsV0MxQjdELFNBQVNLLEVBQ1pDLEVBQ0FDLEVBQ0FDLEdBRUEsTUFBTyxDQUNIQyxjQUFjLEVBQ2RDLFlBQVksRUFDWixNQUNJLE9BQU9GLEVBQVdHLE1BQU1DLEtBQUtwQixRQ1R6QyxJQUFZcUIsR0FBWixTQUFZQSxHQUNSLGtCQUNBLHNCQUZKLENBQVlBLE1BQWEsS0NFbEIsTUFBTUMsRUFPVCxZQUNJQyxFQUNBQyxFQUNBQyxFQUNBQyxHQU5KLEtBQUFBLE9BQXdCTCxFQUFjTSxPQVFsQzNCLEtBQUt1QixNQUFRQSxFQUNidkIsS0FBS3dCLFlBQWNBLEVBQ25CeEIsS0FBS3lCLE9BQVNBLEVBQ2R6QixLQUFLVSxHQUFLa0IsS0FBS0MsU0FBU0MsV0FDcEJKLElBQVExQixLQUFLMEIsT0FBU0EsSUNkM0IsTUFBTUssRUFZVCxjQVhRLEtBQUFDLFVBQXVCLEdBQ3ZCLEtBQUFDLFdBQXlCLEdBR2pDLHFCQUNJLE9BQUlqQyxLQUFLa0MsWUFFVGxDLEtBQUtrQyxVQUFZLElB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QUFPLGFBSW5ELGlCQUNTL0YsU0FDUkMsZUFBZSxHQUFHSCxLQUFLMEYsaUJBQ3ZCL0IsY0FBYyxNQUVkdUMsVUFBWSxHQUVqQmxHLEtBQUsyRixTQUFTOUMsU0FBU04sSUFDbkIsSUFBSXVDLEVBQVksR0FBRzlFLEtBQUswRixxQkFBc0JuRCxNQUk1QyxZQUNOUSxFQUFhb0QsYUFBWSxLQUNyQm5HLEtBQUsyRixTQUFXNUMsRUFBYXFELFlBQVlwRyxLQUFLMEYsTUFDOUMxRixLQUFLcUcsb0JBR1RyRyxLQUFLUSxRQUFRbUQsY0FBYyxNQUFPakQsR0FBSyxHQUFHVixLQUFLMEYscUJBQy9DMUYsS0FBS1EsUUFBUW9FLGlCQUFpQixXQUFZNUUsS0FBS3NHLGlCQUMvQ3RHLEtBQUtRLFFBQVFvRSxpQkFBaUIsWUFBYTVFLEtBQUt1RyxrQkFDaER2RyxLQUFLUSxRQUFRb0UsaUJBQWlCLE9BQVE1RSxLQUFLd0csaUJBR3JDLGlCQUNOeEcsS0FBS1EsUUFBUW1ELGNBQ1QsTUFDRDRCLFlBQWMsR0FBR3ZGLEtBQUswRixLQUFLZSwwQkF0RGxDLEdBREM1RixHLG9DQVlELEdBRENBLEcsb0NBUUQsR0FEQ0EsRyxxQ0NqQ0wsSUFBSTJDLEVBQ0osSUFBSWlDLEVBQWFwRSxFQUFjTSxRQUMvQixJQUFJOEQsRUFBYXBFLEVBQWN1QixXIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzPFQgZXh0ZW5kcyBIVE1MRWxlbWVudCwgVSBleHRlbmRzIEhUTUxFbGVtZW50PiB7XG4gICAgdGVtcGxhdGVFbDogSFRNTFRlbXBsYXRlRWxlbWVudFxuICAgIHRhcmdldE5vZGU6IFRcbiAgICBlbGVtZW50OiBVXG5cbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0b3IoXG4gICAgICAgIHRlbXBsYXRlSWQ6IHN0cmluZyxcbiAgICAgICAgdGFyZ2V0Tm9kZUlkOiBzdHJpbmcsXG4gICAgICAgIGluc2VydEF0U3RhcnQ6IGJvb2xlYW4sXG4gICAgICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZyxcbiAgICApIHtcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgICAgICAgICB0ZW1wbGF0ZUlkLFxuICAgICAgICApISBhcyBIVE1MVGVtcGxhdGVFbGVtZW50XG5cbiAgICAgICAgdGhpcy50YXJnZXROb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0Tm9kZUlkKSEgYXMgVFxuICAgICAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKHRoaXMudGVtcGxhdGVFbC5jb250ZW50LCB0cnVlKVxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQhIGFzIFVcbiAgICAgICAgaWYgKG5ld0VsZW1lbnRJZCkgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkXG4gICAgICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0QXRTdGFydDogYm9vbGVhbikge1xuICAgICAgICBpZiAoaW5zZXJ0QXRTdGFydCkge1xuICAgICAgICAgICAgdGhpcy50YXJnZXROb2RlLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJiZWdpbicsIHRoaXMuZWxlbWVudClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0Tm9kZS5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIHRoaXMuZWxlbWVudClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjb25maWd1cmUoKTogdm9pZFxuXG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IHJlbmRlckNvbnRlbnRzKCk6IHZvaWRcbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBBdXRvYmluZChcbiAgICBfMTogYW55LFxuICAgIF8yOiBzdHJpbmcsXG4gICAgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yLFxuKTogUHJvcGVydHlEZXNjcmlwdG9yIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVzY3JpcHRvci52YWx1ZS5iaW5kKHRoaXMpXG4gICAgICAgIH0sXG4gICAgfSBhcyBQcm9wZXJ0eURlc2NyaXB0b3Jcbn1cbiIsImV4cG9ydCBlbnVtIFByb2plY3RTdGF0dXMge1xuICAgIEFDVElWRSA9ICdhY3RpdmUnLFxuICAgIElOQUNUSVZFID0gJ2ZpbmlzaGVkJyxcbn1cbiIsImltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9lbnVtcydcblxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xuICAgIGlkOiBzdHJpbmdcbiAgICB0aXRsZTogc3RyaW5nXG4gICAgZGVzY3JpcHRpb246IHN0cmluZ1xuICAgIHBlb3BsZTogbnVtYmVyXG4gICAgc3RhdHVzOiBQcm9qZWN0U3RhdHVzID0gUHJvamVjdFN0YXR1cy5BQ1RJVkVcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICB0aXRsZTogc3RyaW5nLFxuICAgICAgICBkZXNjcmlwdGlvbjogc3RyaW5nLFxuICAgICAgICBwZW9wbGU6IG51bWJlcixcbiAgICAgICAgc3RhdHVzPzogUHJvamVjdFN0YXR1cyxcbiAgICApIHtcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvblxuICAgICAgICB0aGlzLnBlb3BsZSA9IHBlb3BsZVxuICAgICAgICB0aGlzLmlkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygpXG4gICAgICAgIGlmIChzdGF0dXMpIHRoaXMuc3RhdHVzID0gc3RhdHVzXG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0J1xuaW1wb3J0IHsgUHJvamVjdFN0YXR1cyB9IGZyb20gJy4uL2VudW1zJ1xuXG50eXBlIFByb2plY3REYXRhID0gW3N0cmluZywgc3RyaW5nLCBudW1iZXJdXG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUge1xuICAgIHByaXZhdGUgX3Byb2plY3RzOiBQcm9qZWN0W10gPSBbXVxuICAgIHByaXZhdGUgX2xpc3RlbmVyczogRnVuY3Rpb25bXSA9IFtdXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2luc3RhbmNlOiBQcm9qZWN0U3RhdGVcblxuICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2luc3RhbmNlKSByZXR1cm4gdGhpcy5faW5zdGFuY2VcblxuICAgICAgICB0aGlzLl9pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKVxuICAgICAgICByZXR1cm4gdGhpcy5faW5zdGFuY2VcbiAgICB9XG5cbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xuICAgIH1cblxuICAgIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBsaXN0VHlwZTogUHJvamVjdFN0YXR1cykge1xuICAgICAgICBjb25zdCBwcm9qZWN0SW5zdGFuY2UgPSB0aGlzLl9wcm9qZWN0cy5maW5kKFxuICAgICAgICAgICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09IHByb2plY3RJZCxcbiAgICAgICAgKVxuICAgICAgICBpZiAocHJvamVjdEluc3RhbmNlKSBwcm9qZWN0SW5zdGFuY2Uuc3RhdHVzID0gbGlzdFR5cGVcbiAgICAgICAgdGhpcy5jYWxsTGlzdGVuZXJzKClcbiAgICB9XG5cbiAgICBhZGRQcm9qZWN0KHByb2plY3REYXRhOiBQcm9qZWN0RGF0YSk6IHZvaWQge1xuICAgICAgICB0aGlzLl9wcm9qZWN0cy5wdXNoKG5ldyBQcm9qZWN0KC4uLnByb2plY3REYXRhKSlcbiAgICAgICAgdGhpcy5jYWxsTGlzdGVuZXJzKClcbiAgICB9XG5cbiAgICBnZXRQcm9qZWN0cyhzdGF0dXM/OiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgICAgIHN3aXRjaCAoc3RhdHVzKSB7XG4gICAgICAgICAgICBjYXNlIFByb2plY3RTdGF0dXMuQUNUSVZFOlxuICAgICAgICAgICAgICAgIHJldHVybiBbLi4udGhpcy5fcHJvamVjdHNdLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgKHByb2plY3QpID0+IHByb2plY3Quc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFDVElWRSxcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICBjYXNlIFByb2plY3RTdGF0dXMuSU5BQ1RJVkU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9wcm9qZWN0c10uZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAocHJvamVjdCkgPT4gcHJvamVjdC5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuSU5BQ1RJVkUsXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gWy4uLnRoaXMuX3Byb2plY3RzXVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxsTGlzdGVuZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9saXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IGxpc3RlbmVyKCkpXG4gICAgfVxuXG4gICAgYWRkTGlzdGVuZXIobGlzdGVuZXI6IEZ1bmN0aW9uKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2xpc3RlbmVycy5wdXNoKGxpc3RlbmVyKVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpXG4iLCJleHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxlTnVtYmVyIHtcbiAgICB2YWx1ZTogbnVtYmVyXG4gICAgbWluPzogbnVtYmVyXG4gICAgbWF4PzogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGVTdHJpbmcge1xuICAgIHZhbHVlOiBzdHJpbmdcbiAgICBtaW5MZW5ndGg/OiBudW1iZXJcbiAgICBtYXhMZW5ndGg/OiBudW1iZXJcbn1cblxuZXhwb3J0IHR5cGUgVmFsaWRhdGFibGUgPSBWYWxpZGF0YWJsZU51bWJlciB8IFZhbGlkYXRhYmxlU3RyaW5nXG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0aW9uOiBWYWxpZGF0YWJsZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHsgdmFsdWUgfSA9IHZhbGlkYXRpb25cblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGNvbnN0IHsgbWluTGVuZ3RoLCBtYXhMZW5ndGggfSA9IHZhbGlkYXRpb24gYXMgVmFsaWRhdGFibGVTdHJpbmdcbiAgICAgICAgaWYgKG1pbkxlbmd0aCAmJiBtaW5MZW5ndGggPiB2YWx1ZS5sZW5ndGgpIHJldHVybiBmYWxzZVxuICAgICAgICBpZiAobWF4TGVuZ3RoICYmIG1heExlbmd0aCA8IHZhbHVlLmxlbmd0aCkgcmV0dXJuIGZhbHNlXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdmFsaWRhdGlvbiBhcyBWYWxpZGF0YWJsZU51bWJlclxuICAgICAgICBpZiAobWluICYmIG1pbiA+IHZhbHVlKSByZXR1cm4gZmFsc2VcbiAgICAgICAgaWYgKG1heCAmJiBtYXggPCB2YWx1ZSkgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWVcbn0iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4vYmFzZSdcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycydcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3RzJ1xuaW1wb3J0ICogYXMgVmFsaWRhdGlvbiBmcm9tICcuLi92YWxpZGF0aW9ucydcblxuZXhwb3J0IGNsYXNzIFByb2plY3RzSW5wdXQgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxGb3JtRWxlbWVudD4ge1xuICAgIHRpdGxlSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnRcbiAgICBkZXNjcmlwdGlvbklucHV0OiBIVE1MVGV4dEFyZWFFbGVtZW50XG4gICAgcGVvcGxlSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnRcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigncHJvamVjdC1pbnB1dCcsICdhcHAnLCB0cnVlLCAndXNlci1pbnB1dCcpXG5cbiAgICAgICAgdGhpcy50aXRsZUlucHV0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAnI3RpdGxlJyxcbiAgICAgICAgKSEgYXMgSFRNTElucHV0RWxlbWVudFxuXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJyNkZXNjcmlwdGlvbicsXG4gICAgICAgICkhIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnRcblxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAnI3Blb3BsZScsXG4gICAgICAgICkhIGFzIEhUTUxJbnB1dEVsZW1lbnRcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudHMoKVxuICAgIH1cblxuICAgIEBBdXRvYmluZFxuICAgIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKVxuXG4gICAgICAgIGlmIChpbnB1dFZhbHVlcykge1xuICAgICAgICAgICAgcHJvamVjdFN0YXRlLmFkZFByb2plY3QoaW5wdXRWYWx1ZXMpXG4gICAgICAgICAgICB0aGlzLmNsZWFySW5wdXRWYWx1ZXMoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0VmFsdWVzKCkge1xuICAgICAgICB0aGlzLnRpdGxlSW5wdXQudmFsdWUgPSAnJ1xuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSAnJ1xuICAgICAgICB0aGlzLnBlb3BsZUlucHV0LnZhbHVlID0gJydcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldElucHV0VmFsdWVzKCk6IFtzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xuICAgICAgICBjb25zdCB0aXRsZUlucHV0VmFsdWUgPSB0aGlzLnRpdGxlSW5wdXQudmFsdWVcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25JbnB1dFZhbHVlID0gdGhpcy5kZXNjcmlwdGlvbklucHV0LnZhbHVlXG4gICAgICAgIGNvbnN0IHBlb3BsZUlucHV0VmFsdWUgPSB0aGlzLnBlb3BsZUlucHV0LnZhbHVlXG5cbiAgICAgICAgY29uc3QgdGl0bGVJbnB1dFZhbGlkYXRpb246IFZhbGlkYXRpb24uVmFsaWRhdGFibGVTdHJpbmcgPSB7XG4gICAgICAgICAgICB2YWx1ZTogdGl0bGVJbnB1dFZhbHVlLFxuICAgICAgICAgICAgbWluTGVuZ3RoOiAxLFxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb25JbnB1dFZhbGlkYXRpb246IFZhbGlkYXRpb24uVmFsaWRhdGFibGVTdHJpbmcgPSB7XG4gICAgICAgICAgICB2YWx1ZTogZGVzY3JpcHRpb25JbnB1dFZhbHVlLFxuICAgICAgICAgICAgbWluTGVuZ3RoOiA1LFxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGVvcGxlSW5wdXRWYWxpZGF0aW9uOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlTnVtYmVyID0ge1xuICAgICAgICAgICAgdmFsdWU6ICtwZW9wbGVJbnB1dFZhbHVlLFxuICAgICAgICAgICAgbWluOiAxLFxuICAgICAgICAgICAgbWF4OiAxMCxcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgICFWYWxpZGF0aW9uLnZhbGlkYXRlKHRpdGxlSW5wdXRWYWxpZGF0aW9uKSB8fFxuICAgICAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUoZGVzY3JpcHRpb25JbnB1dFZhbGlkYXRpb24pIHx8XG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShwZW9wbGVJbnB1dFZhbGlkYXRpb24pXG4gICAgICAgICkge1xuICAgICAgICAgICAgYWxlcnQoJ0ludmFsaWQgaW5wdXQgdmFsdWVzIScpXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbdGl0bGVJbnB1dFZhbHVlLCBkZXNjcmlwdGlvbklucHV0VmFsdWUsICtwZW9wbGVJbnB1dFZhbHVlXVxuICAgIH1cblxuICAgIHByb3RlY3RlZCByZW5kZXJDb250ZW50cygpIHtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY29uZmlndXJlKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKVxuICAgIH1cbn1cbiIsImltcG9ydCBDb21wb25lbnQgZnJvbSAnLi9iYXNlJ1xuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCdcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycydcblxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtXG4gICAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD5cbiAgICBpbXBsZW1lbnRzIERyYWdnYWJsZSB7XG4gICAgcHJpdmF0ZSBfcHJvamVjdDogUHJvamVjdFxuXG4gICAgZ2V0IHByb2plY3RNZW1iZXJzKCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMuX3Byb2plY3QucGVvcGxlKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuICcxIG1lbWJlcidcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMuX3Byb2plY3QucGVvcGxlfSBtZW1iZXJzYFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3QpIHtcbiAgICAgICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSlcbiAgICAgICAgdGhpcy5fcHJvamVjdCA9IHByb2plY3RcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnRzKClcbiAgICB9XG5cbiAgICBAQXV0b2JpbmRcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5zZXREYXRhKCd0ZXh0L3BsYWluJywgdGhpcy5fcHJvamVjdC5pZClcbiAgICAgICAgZXZlbnQuZGF0YVRyYW5zZmVyIS5lZmZlY3RBbGxvd2VkID0gJ21vdmUnXG4gICAgfVxuXG4gICAgQEF1dG9iaW5kXG4gICAgZHJhZ0VuZEhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNvbmZpZ3VyZSgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gdGhpcy5fcHJvamVjdC5pZFxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKVxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHJlbmRlckNvbnRlbnRzKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLl9wcm9qZWN0LnRpdGxlXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdE1lbWJlcnNcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLl9wcm9qZWN0LmRlc2NyaXB0aW9uXG4gICAgfVxufVxuIiwiaW1wb3J0IENvbXBvbmVudCBmcm9tICcuL2Jhc2UnXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSAnLi4vaW50ZXJmYWNlcydcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCdcbmltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9lbnVtcydcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycydcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3RzJ1xuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tICcuL3Byb2plY3QtaXRlbSdcblxuZXhwb3J0IGNsYXNzIFByb2plY3RzTGlzdFxuICAgIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD5cbiAgICBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xuICAgIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXVxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiBQcm9qZWN0U3RhdHVzKSB7XG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYClcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnRzKClcbiAgICB9XG5cbiAgICBAQXV0b2JpbmRcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIgJiZcbiAgICAgICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nXG4gICAgICAgICkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBAQXV0b2JpbmRcbiAgICBkcmFnRHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBjb25zdCBwcm9qZWN0SWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKVxuICAgICAgICBwcm9qZWN0U3RhdGUubW92ZVByb2plY3QocHJvamVjdElkLCB0aGlzLnR5cGUpXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKVxuICAgIH1cblxuICAgIEBBdXRvYmluZFxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIgJiZcbiAgICAgICAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci50eXBlc1swXSA9PT0gJ3RleHQvcGxhaW4nXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xuICAgICAgICBjb25zdCBsaXN0ID0gZG9jdW1lbnRcbiAgICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzYCkhXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcigndWwnKSEgYXMgSFRNTFVMaXN0RWxlbWVudFxuXG4gICAgICAgIGxpc3QuaW5uZXJIVE1MID0gJydcblxuICAgICAgICB0aGlzLnByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IHtcbiAgICAgICAgICAgIG5ldyBQcm9qZWN0SXRlbShgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgLCBwcm9qZWN0KVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBjb25maWd1cmUoKSB7XG4gICAgICAgIHByb2plY3RTdGF0ZS5hZGRMaXN0ZW5lcigoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnByb2plY3RzID0gcHJvamVjdFN0YXRlLmdldFByb2plY3RzKHRoaXMudHlwZSlcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdHMoKVxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGBcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3ZlckhhbmRsZXIpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZUhhbmRsZXIpXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcmFnRHJvcEhhbmRsZXIpXG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHJlbmRlckNvbnRlbnRzKCkge1xuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICdoMicsXG4gICAgICAgICkhLnRleHRDb250ZW50ID0gYCR7dGhpcy50eXBlLnRvVXBwZXJDYXNlKCl9IFBST0pFQ1RTYFxuICAgIH1cbn1cbiIsImltcG9ydCB7IFByb2plY3RzSW5wdXQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCdcbmltcG9ydCB7IFByb2plY3RzTGlzdCB9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnXG5pbXBvcnQgeyBQcm9qZWN0U3RhdHVzIH0gZnJvbSAnLi9lbnVtcydcblxubmV3IFByb2plY3RzSW5wdXQoKVxubmV3IFByb2plY3RzTGlzdChQcm9qZWN0U3RhdHVzLkFDVElWRSlcbm5ldyBQcm9qZWN0c0xpc3QoUHJvamVjdFN0YXR1cy5JTkFDVElWRSkiXSwic291cmNlUm9vdCI6IiJ9